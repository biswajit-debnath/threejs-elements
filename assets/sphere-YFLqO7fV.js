import{e as q,H as L,F as D,f as B,L as O,g as P,S as X,P as J,W as K,E as Q,O as Z}from"./OrbitControls-B0m5gDpG.js";import{G as ee}from"./GLTFLoader-ByhcPwtY.js";class re extends q{constructor(m){super(m),this.type=L}parse(m){const c=function(e,a){switch(e){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(a||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(a||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(a||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(a||""))}},v=function(e,a,t){a=a||1024;let s=e.pos,i=-1,r=0,l="",n=String.fromCharCode.apply(null,new Uint16Array(e.subarray(s,s+128)));for(;0>(i=n.indexOf(`
`))&&r<a&&s<e.byteLength;)l+=n,r+=n.length,s+=128,n+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(s,s+128)));return-1<i?(e.pos+=r+i+1,l+n.slice(0,i)):!1},C=function(e){const a=/^#\?(\S+)/,t=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*FORMAT=(\S+)\s*$/,i=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,r={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let l,n;for((e.pos>=e.byteLength||!(l=v(e)))&&c(1,"no header found"),(n=l.match(a))||c(3,"bad initial token"),r.valid|=1,r.programtype=n[1],r.string+=l+`
`;l=v(e),l!==!1;){if(r.string+=l+`
`,l.charAt(0)==="#"){r.comments+=l+`
`;continue}if((n=l.match(t))&&(r.gamma=parseFloat(n[1])),(n=l.match(o))&&(r.exposure=parseFloat(n[1])),(n=l.match(s))&&(r.valid|=2,r.format=n[1]),(n=l.match(i))&&(r.valid|=4,r.height=parseInt(n[1],10),r.width=parseInt(n[2],10)),r.valid&2&&r.valid&4)break}return r.valid&2||c(3,"missing format specifier"),r.valid&4||c(3,"missing image size specifier"),r},x=function(e,a,t){const o=a;if(o<8||o>32767||e[0]!==2||e[1]!==2||e[2]&128)return new Uint8Array(e);o!==(e[2]<<8|e[3])&&c(3,"wrong scanline width");const s=new Uint8Array(4*a*t);s.length||c(4,"unable to allocate buffer space");let i=0,r=0;const l=4*o,n=new Uint8Array(4),w=new Uint8Array(l);let V=t;for(;V>0&&r<e.byteLength;){r+4>e.byteLength&&c(1),n[0]=e[r++],n[1]=e[r++],n[2]=e[r++],n[3]=e[r++],(n[0]!=2||n[1]!=2||(n[2]<<8|n[3])!=o)&&c(3,"bad rgbe scanline format");let y=0,d;for(;y<l&&r<e.byteLength;){d=e[r++];const h=d>128;if(h&&(d-=128),(d===0||y+d>l)&&c(3,"bad scanline data"),h){const _=e[r++];for(let z=0;z<d;z++)w[y++]=_}else w.set(e.subarray(r,r+d),y),y+=d,r+=d}const j=o;for(let h=0;h<j;h++){let _=0;s[i]=w[h+_],_+=o,s[i+1]=w[h+_],_+=o,s[i+2]=w[h+_],_+=o,s[i+3]=w[h+_],i+=4}V--}return s},Y=function(e,a,t,o){const s=e[a+3],i=Math.pow(2,s-128)/255;t[o+0]=e[a+0]*i,t[o+1]=e[a+1]*i,t[o+2]=e[a+2]*i,t[o+3]=1},$=function(e,a,t,o){const s=e[a+3],i=Math.pow(2,s-128)/255;t[o+0]=B.toHalfFloat(Math.min(e[a+0]*i,65504)),t[o+1]=B.toHalfFloat(Math.min(e[a+1]*i,65504)),t[o+2]=B.toHalfFloat(Math.min(e[a+2]*i,65504)),t[o+3]=B.toHalfFloat(1)},b=new Uint8Array(m);b.pos=0;const R=C(b),N=R.width,U=R.height,G=x(b.subarray(b.pos),N,U);let M,A,g;switch(this.type){case D:g=G.length/4;const e=new Float32Array(g*4);for(let t=0;t<g;t++)Y(G,t*4,e,t*4);M=e,A=D;break;case L:g=G.length/4;const a=new Uint16Array(g*4);for(let t=0;t<g;t++)$(G,t*4,a,t*4);M=a,A=L;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:N,height:U,data:M,header:R.string,gamma:R.gamma,exposure:R.exposure,type:A}}setDataType(m){return this.type=m,this}load(m,I,T,H){function f(c,k){switch(c.type){case D:case L:c.colorSpace=O,c.minFilter=P,c.magFilter=P,c.generateMipmaps=!1,c.flipY=!0;break}I&&I(c,k)}return super.load(m,f,T,H)}}const S=new X,E=new J(75,window.innerWidth/window.innerHeight,.1,1e3);E.position.z=500;E.position.y=10;const ae=document.querySelector(".canvas"),u=new K({canvas:ae});u.setSize(window.innerWidth,window.innerHeight);const ne=new re;ne.load("https://dl.polyhaven.org/file/ph-assets/HDRIs/hdr/1k/sunny_country_road_1k.hdr",p=>{p.mapping=Q,S.background=p,S.environment=p});const te=new ee;te.load("./3d-models/medieval_box.glb",p=>{S.add(p.scene)});window.addEventListener("resize",()=>{u.setSize(window.innerWidth,window.innerHeight),E.aspect=window.innerWidth/window.innerHeight,E.updateProjectionMatrix()});const F=new Z(E,u.domElement);F.enableDamping=!0;F.autoRotate=!0;F.autoRotateSpeed=2;function W(){requestAnimationFrame(W),F.update(),u.render(S,E)}W();
